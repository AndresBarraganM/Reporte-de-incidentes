<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generación y Exportación de Reportes</title>
  <link rel="stylesheet" href="reporte.css">
  <!-- Incluimos Chart.js desde CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <aside class="menu-lateral">
    <h2>Menú</h2>
    <nav>
      <ul>
        <li><a href="#">Inicio</a></li>
        <li><a href="#">Incidentes</a></li>
        <li><a href="#">Reportes</a></li>
        <li><a href="#">Configuración</a></li>
      </ul>
    </nav>
  </aside>

  <div class="container">
    <header>
      <h1>Generación y Exportación de Reportes</h1>
      <p>Filtra, exporta y analiza los incidentes para tomar decisiones informadas.</p>
    </header>
    
    <section class="filtros-avanzados">
      <h2>Filtros Avanzados</h2>
      <form id="form-filtros">
        <div class="campo">
          <label for="fecha-inicio">Fecha Inicio:</label>
          <input type="date" id="fecha-inicio" name="fecha-inicio">
        </div>
        <div class="campo">
          <label for="fecha-fin">Fecha Fin:</label>
          <input type="date" id="fecha-fin" name="fecha-fin">
        </div>
        <div class="campo">
          <label for="ubicacion">Ubicación:</label>
          <select id="ubicacion" name="ubicacion">
            <option value="">Todas</option>
            <option value="banio1">Baño 1</option>
            <option value="banio2">Baño 2</option>
            <!-- Más opciones según necesidad -->
          </select>
        </div>
        <div class="campo">
          <label for="estado">Estado:</label>
          <select id="estado" name="estado">
            <option value="">Todos</option>
            <option value="pendiente">Pendiente</option>
            <option value="en-proceso">En Proceso</option>
            <option value="resuelto">Resuelto</option>
          </select>
        </div>
        <button type="submit">Aplicar Filtros</button>
      </form>
    </section>

  <!-- Sección de Exportación de Datos -->
    <section class="exportacion">
      <h2>Exportación de Datos</h2>
      <p>Descarga los reportes en formatos CSV o PDF para análisis externos o reuniones.</p>
      <div class="botones-exportacion">
        <button id="export-csv">Exportar CSV</button>
        <button id="export-pdf">Exportar PDF</button>
      </div>
    </section>
    </section>

    <!-- Sección de Estadísticas Avanzadas -->
    <section class="estadisticas-avanzadas">
      <h2>Estadísticas Avanzadas</h2>
      <p>Visualiza tendencias por hora, día y ubicación, y realiza comparativas entre periodos.</p>
      <div class="graficos">
        <!-- Aquí insertamos nuestra gráfica de barras -->
        <div class="grafico">
          <canvas id="graficaDanios" width="600" height="400"></canvas>
        </div>
        <div class="grafico" id="grafico-comparativo">
          <p>Gráfico Comparativo</p>
        </div>
      </div>
    </section>
  </div>

  <!-- Script para generar la gráfica con Chart.js -->
  <script>
    /**
     * Genera una gráfica de barras de reportes por tipo de daño.
     * @param {string} canvasId   — Id del elemento <canvas>.
     * @param {string[]} tipos     — Array con los nombres de cada tipo de daño.
     * @param {number[]} cantidades— Array con la cantidad de reportes correspondiente.
     * @param {string} [titulo]    — (Opcional) Título de la gráfica.
     * @returns {Chart}            — Instancia de Chart.js.
     */
    function generarGraficaDanios(canvasId, tipos, cantidades, titulo = 'Reportes por tipo de daño') {
      const ctx = document.getElementById(canvasId).getContext('2d');
      return new Chart(ctx, {
        type: 'bar',
        data: {
          labels: tipos,
          datasets: [{
            label: 'Cantidad de reportes',
            data: cantidades,
            backgroundColor: 'rgba(54, 162, 235, 0.6)',
            borderColor: 'rgba(54, 162, 235, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: titulo,
              font: { size: 18 }
            },
            legend: { display: false }
          },
          scales: {
            x: {
              title: { display: true, text: 'Tipo de daño' },
              ticks: { maxRotation: 45, minRotation: 0 }
            },
            y: {
              title: { display: true, text: 'Cantidad de reportes' },
              beginAtZero: true,
              precision: 0
            }
          }
        }
      });
    }

    // EJEMPLO: datos estáticos. Cámbialos por tu array real o por datos que obtengas vía fetch.
    const tipos = ['Obstrucción', 'Fugas', 'Vandalismo', 'Mantenimiento'];
    const cantidades = [12, 7, 5, 3];

    // Al cargar la página, generamos la gráfica
    window.addEventListener('DOMContentLoaded', () => {
      generarGraficaDanios('graficaDanios', tipos, cantidades);
    });
  </script>
</body>
</html>
